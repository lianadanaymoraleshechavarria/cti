{% extends "base.html" %}
{% load static %}

{% block css %}
  <link rel="stylesheet" href="{% static 'css/forms.css' %}">
  <style>
    /* Estilos para secciones organizadas */
    .dashed-rounded-border {
      border: 1px dashed #64748b;
      border-radius: 1.5rem;
      padding: 1.5rem;
      margin-top: 1.5rem;
      position: relative;
    }
    
    .section-label {
      position: absolute;
      top: -12px;
      left: 20px;
      background-color: #f97316;
      color: white;
      padding: 4px 16px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .form-control {
      border: 2px solid #3b82f6;
      border-radius: 0.375rem;
      background-color: #f8f9fa;
    }
    
    .readonly-input {
      background-color: #e9ecef;
      cursor: not-allowed;
    }
    
    .autor-badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      margin: 0.25rem;
      font-size: 0.875rem;
      font-weight: 500;
      line-height: 1;
      color: #fff;
      background-color: #007bff;
      border-radius: 0.25rem;
    }

    .download-link {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 1rem;
      background-color: #28a745;
      color: white;
      text-decoration: none;
      border-radius: 0.375rem;
      font-weight: 500;
      transition: background-color 0.2s;
    }

    .download-link:hover {
      background-color: #218838;
      color: white;
      text-decoration: none;
    }

    .no-file-message {
      color: #6c757d;
      font-style: italic;
      padding: 0.5rem;
      background-color: #f8f9fa;
      border-radius: 0.375rem;
      border: 1px dashed #dee2e6;
    }

    .status-badge {
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-weight: 500;
      text-transform: uppercase;
      font-size: 0.875rem;
    }

    .status-approved {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-pending {
      background-color: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .status-rejected {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>
{% endblock %}

{% block content %}
  <div class="content">
    <div class="col">
      <div class="container-form">
        <div class="form">
          <div class="container-fluid py-4">
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <div class="title">
                      <h3 class="title-text p-3">Detalles del Artículo</h3>
                      <p class="text">
                        Información completa del artículo registrado en el sistema.
                      </p>
                    </div>
                  </div>
                  
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="form-header">INFORMACIÓN DEL ARTÍCULO</div>
                        
                        <!-- Información básica del artículo -->
                        <div class="dashed-rounded-border">
                          <div class="section-label">Información básica de la publicacion</div>
                          
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">Título</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.titulo }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">Autores</label>
                                <div class="form-control readonly-input" style="height: auto; min-height: 38px;">
                                  {% if articulo.autores.all %}
                                    <div class="d-flex flex-wrap">
                                      {% for autor in articulo.autores.all %}
                                        <span class="autor-badge">
                                          {{ autor.get_full_name|default:autor.username }}
                                        </span>
                                      {% endfor %}
                                    </div>
                                  {% else %}
                                    <span class="text-muted">No hay autores seleccionados</span>
                                  {% endif %}
                                </div>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Fecha de Creación</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.fecha_creacion|date:'d/m/Y' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">ISSN</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.issn|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">DOI</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.doi|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                          </div>
                        </div>

                        <!-- Datos de la Revista o Medio de Publicación -->
                        <div class="dashed-rounded-border mt-4">
                          <div class="section-label" style="background-color: #8b5cf6;">Datos de la Revista o Medio de Publicación</div>
                          
                          <div class="row">
                            <div class="col-md-6">
                              <div class="form-group">
                                <label class="form-control-label">Editorial</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.editorial|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-6">
                              <div class="form-group">
                                <label class="form-control-label">País</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.get_pais_display|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Volumen</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.volumen|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Número</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.numero|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Páginas</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.pag|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">URL de Publicación</label>
                                {% if articulo.url %}
                                  <div class="form-control readonly-input">
                                    <a href="{{ articulo.url }}" target="_blank" class="text-primary">
                                      {{ articulo.url }}
                                    </a>
                                  </div>
                                {% else %}
                                  <div class="no-file-message">
                                    No se ha especificado URL de publicación
                                  </div>
                                {% endif %}
                              </div>
                            </div>
                            
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">Forma de citar</label>
                                <textarea class="form-control readonly-input" readonly>{{ articulo.cita|default:'No especificado' }}</textarea>
                              </div>
                            </div>
                            
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">Archivo Adjunto</label>
                                {% if articulo.archivo %}
                                  <div>
                                    <a href="{{ articulo.archivo.url }}" download class="download-link">
                                      <i class="fas fa-download me-2"></i>
                                      Descargar Archivo
                                    </a>
                                  </div>
                                {% else %}
                                  <div class="no-file-message">
                                    No hay archivo disponible
                                  </div>
                                {% endif %}
                              </div>
                            </div>
                          </div>
                        </div>
                        
                        <!-- Información adicional -->
                        <div class="dashed-rounded-border mt-4">
                          <div class="section-label" style="background-color: #10b981;">Información adicional</div>
                          
                          <div class="row">
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Departamento</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.departamento|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Área</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.area|default:'No especificado' }}" readonly>
                              </div>
                            </div>
                            
                            <div class="col-md-4">
                              <div class="form-group">
                                <label class="form-control-label">Estado</label>
                                <div class="form-control readonly-input">
                                  <span class="status-badge 
                                    {% if articulo.aprobacion == 'Aprobado' %}status-approved
                                    {% elif articulo.aprobacion == 'Rechazado' %}status-rejected
                                    {% else %}status-pending{% endif %}">
                                    {{ articulo.get_aprobacion_display }}
                                  </span>
                                </div>
                              </div>
                            </div>
                            
                            {% if articulo.proyecto %}
                            <div class="col-md-12">
                              <div class="form-group">
                                <label class="form-control-label">Proyecto asociado</label>
                                <input type="text" class="form-control readonly-input" value="{{ articulo.proyecto.nombre_proyecto }}" readonly>
                              </div>
                            </div>
                            {% endif %}
                          </div>
                        </div>
                        
                        <!-- Botones -->
                        <div class="row mt-4">
                          <div class="col-md-12 text-center">
                            {% if articulo.usuario == request.user and articulo.aprobacion != 'Aprobado' %}
                              <a href="{% url 'Articulo_Revista_Update_Investigador' articulo.id %}" class="btn btn-warning">
                                <i class="fas fa-edit me-2"></i>Editar
                              </a>
                            {% endif %}
                            <a href="{% url 'Articulo_List_Investigador' %}" class="btn btn-primary ml-3">
                              <i class="fas fa-arrow-left me-2"></i>Volver
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>    
    </div>
  </div>
{% endblock %}

{% block js %}
  <script src="{% static 'js/validations.js' %}"></script>
{% endblock %}